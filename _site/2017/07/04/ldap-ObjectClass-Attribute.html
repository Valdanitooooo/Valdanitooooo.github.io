<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="author" content="Valdanito" />
    <meta name="keywords" content="Valdanito,Valdanito,正确的理解LDAP中的ObjectClass和Attribute" />
    <meta name="description" content="正确的理解LDAP中的ObjectClass和Attribute" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>正确的理解LDAP中的ObjectClass和Attribute</title>
    <link rel="shortcut icon" href="/media/images/favicon.ico" />
    <link rel="stylesheet" href="/media/css/style.css?v=20150623" />
    <link rel="stylesheet" href="/media/css/iconfont.css?v=20150623" />
    <link rel="stylesheet" href="/media/css/highlight.css?v=20150623" />
    <!--<link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml" />-->
    <!--[if lt IE 9]>
    <div class="bsie">
        您的浏览器版本过旧，请升级为Google Chrome浏览器进行浏览 :-D
        <a href="javascript:void(0);" onclick="this.parentNode.style.display='none';">关闭</a>
    </div>
    <![endif]-->
    
    <!-- Baidu Analytics -->
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?591bc81097305e55717c37659435f4e9";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    <!-- Baidu push -->
    <script>
        (function () {
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https') {
                bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
            }
            else {
                bp.src = 'http://push.zhanzhang.baidu.com/push.js';
            }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-118761201-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-118761201-1');
    </script>

</head>

<body>
   <!--header-->
    <header id="header" class="">
        <i id="btn-open-sidebar" class="icon iconfont">&#xe60a;</i>
        <h1 class="header-title"><a class="header-title-link" href="/">Valdanito</a></h1>
        <a class="header-right-picture" href="/about/" title="Valdanito">
            <img class="header-picture" src="/media/images/avatar.png" alt="头像">
        </a>
    </header>
    <!--sidebar-->
    <nav id="sidebar">
        <div class="sidebar-profile">
            <a href="/about/" title="Valdanito">
                <img src="/media/images/avatar.png" alt="头像" class="sidebar-profile-picture">
            </a>
            <span class="sidebar-profile-name">Valdanito</span>
        </div>
        <ul class="sidebar-buttons">
            <li class="sidebar-button">
                    <a class="sidebar-button-link " href="/">
                        <i class="icon iconfont">&#xe603;</i>
                        <span class="sidebar-button-desc">主&nbsp;&nbsp;&nbsp;&nbsp;页</span>
                    </a>
            </li>
            <li class="sidebar-button">
                    <a class="sidebar-button-link " href="/categories/">
                        <i class="icon iconfont">&#xe601;</i>
                        <span class="sidebar-button-desc">分&nbsp;&nbsp;&nbsp;&nbsp;类</span>
                    </a>
            </li>
            <li class="sidebar-button">
                    <a class="sidebar-button-link " href="/tags/">
                        <i class="icon iconfont">&#xe609;</i>
                        <span class="sidebar-button-desc">标&nbsp;&nbsp;&nbsp;&nbsp;签</span>
                    </a>
            </li>
            <li class="sidebar-button">
                    <a class="sidebar-button-link " href="/guestbook/">

                        <i class="icon iconfont">&#xe606;</i>
                        <span class="sidebar-button-desc">留&nbsp;&nbsp;&nbsp;&nbsp;言</span>
                    </a>
            </li>

            <li class="sidebar-button">

                    <a class="sidebar-button-link" href="/about/">

                        <i class="icon iconfont">&#xe604;</i>
                        <span class="sidebar-button-desc">关&nbsp;&nbsp;&nbsp;&nbsp;于</span>
                    </a>
            </li>

            <li id="sidebar-search" class="sidebar-button">

                    <a class="sidebar-button-link st-search-show-outputs" href="#search">

                        <i class="icon iconfont">&#xe607;</i>
                        <span class="sidebar-button-desc">搜&nbsp;&nbsp;&nbsp;&nbsp;索</span>
                    </a>
            </li>

        </ul>
        <ul class="sidebar-buttons">
            <li class="sidebar-button">
                    <a class="sidebar-button-link " href="http://github.com/Valdanitooooo/" target="_blank">
                        <i class="icon iconfont">&#xe605;</i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            <!-- <li class="sidebar-button">
                    <a class="sidebar-button-link " href="javascript:void(0);" target="_blank">
                        <i class="icon iconfont">&#xe60b;</i>
                        <span class="sidebar-button-desc">知乎</span>
                    </a>
            </li> -->
            <!-- <li class="sidebar-button">
                    <a class="sidebar-button-link " href="http://weibo.com//profile" target="_blank">
                        <i class="icon iconfont">&#xe602;</i>
                        <span class="sidebar-button-desc">Weibo</span>
                    </a>
            </li> -->

        </ul>
        <!-- <ul class="sidebar-buttons">
            <li class="sidebar-button">
                    <a class="sidebar-button-link " href="javascript:void(0);">
                        <i class="icon iconfont">&#xe600;</i>
                        <span class="sidebar-button-desc">RSS订阅</span>
                    </a>
            </li>
        </ul> -->
    </nav>
    <div id="main" role="main">
        <header>
            <h1>正确的理解LDAP中的ObjectClass和Attribute</h1>
        </header>
        <article class="content">
            <section class="meta">
<span class="time">
  <time datetime="2017-07-04">2017-07-04</time>
</span>

 | 
<span class="categories">
  分类
  
  <a href="/categories/#开发" title="开发">开发</a>&nbsp;
  
</span>


 | 
<span class="tags">
  标签
  
  <a href="/tags/#LDAP" title="LDAP">LDAP</a>&nbsp;
  
</span>

</section>
<section class="post">
<p>  初学LDAP,无论是用java还是Python来添加Entry都报了很多错,各种各样的错,原来以为是引用的的第三方库不好用,或者自己代码漏洞太多,甚至配置的LDAP服务器有问题,现在终于搞清楚,其实是自己对ObjectClass和Attribute之间的关系了解的不够透彻,找过许多的中文资料都没有得到答案,现在终于有所突破,赶紧记录下来.
他们之间的关系与Java里面的一些概念很相似，LDAP中每一个Entry必须属于某一个ObjectClass，用Java的方式来理解这个Entry对应着一个Instance，而 ObjectClass自然就是class了。
我们再详细了解一下ObjectClass和Attribute。</p>

<h1 id="objectclass">ObjectClass</h1>

<p>一个ObjectClass是属性的集合（或属性容器），并具有以下特点：</p>

<ol>
  <li>ObjectClass在Schema中定义</li>
  <li>ObjectClass可以是对象类层次结构的一部分，在这种情况下，它继承其父对象的所有属性。 例如，inetOrgPerson是organizationalPerson的子类，organizationalPerson是person的子类，person是top的子类（ABSTRACT objectClass，它终止每个对象类层次结构）。</li>
  <li>ObjectClass具有全局唯一的名称或标识符。</li>
  <li>ObjectClass以及作为属性容器，也是属性，并且可以出现在搜索操作中。</li>
  <li>ObjectClass定义了它的成员属性以及这些属性必须存在（强制）还是可能存在（可选）。</li>
  <li>必须存在一个或多个ObjectClass。</li>
  <li>一个LDAP条目中必须存在一个且只有一个STRUCTURAL ObjectClass。</li>
  <li>由LDAP服务器支持的每个ObjectClass形成称为objectclasses的集合的一部分，可以通过子Schema发现。</li>
</ol>

<p>在Java中Class大致可以分为Abstract，concrete两种，只有concrete Class才能生成Instance。而在LDAP中ObjectClass分为三种：Abstract(抽象型)，Structural(结构型)，Auxiliary(辅助型)。具体定义如下：</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">*</span> Abstract object classes are only intended to be extended by other object classes. An entry must not contain any abstract class unless it also contains a structural or auxiliary class that dervies from that abstract class <span class="o">(</span>i.e., includes a non-abstract object class which has the abstract class <span class="k">in </span>its inheritance chain<span class="o">)</span><span class="nb">.</span> All entries must contain at least the “top” abstract object class, <span class="k">in </span>the inheritance chain <span class="k">for </span>their structural class. They may or may not contain other abstract classes <span class="k">in </span>the inheritance chains <span class="k">for </span>their structural class or any of their auxiliary classes.
<span class="k">*</span> Structural object classes are intended to define the crux of what an entry represents. Every entry must include exactly one structural object class chain, and the root of that chain must ultimately be the “top” abstract object class. The structural object class <span class="k">for </span>an entry is not allowed to be changed.
<span class="k">*</span> Auxiliary object classes are intended to define additional qualities of entries. An entry may contain zero or more auxiliary classes, and the <span class="nb">set </span>of auxiliary classes associated with an entry may change over time.
</code></pre></div></div>

<p>简单描述就是:
抽象型ObjectClass只用来被其它ObjectClass继承，只有当其被结构型ObjectClass继承时才出现。
要定义一个Entry必须有且只有一个结构型的ObjectClass。
Top是一个顶级抽象型ObjectClass，里面定义了一个MUST Attribute：ObjectClass，这就决定了必须有一个其它的结构型ObjectClass才能定义一个Entry.	其中ObjectClass又可以存在继承关系，该继承关系于Java中有点相似，子ObjectClass会继承父ObjectClass中的全部Attributes.
objectClass有着严格的等级之分，最顶层是top和alias。例如，organizationalPerson这个ObjectClass就隶属于person，而person又隶属于top。</p>

<h1 id="attribute">Attribute</h1>

<p>属性（Attribute）类似于程序设计中的变量，可以被赋值。在OpenLDAP中声明了许多常用的Attribute（用户也可自己定义Attribute）。
ObjectClass可以看做是一种特殊的Attribute，它包含其他用到的Attribute以及其自身。</p>

<h1 id="objectclass与attribute的关系">ObjectClass与Attribute的关系</h1>

<p>接下来看一看ObjectClass与Attribute的关系。
如同Java里面的一个类可以包括多个Field，在业务上可能会定义某些Field是必须的，另外一些是可选的。在LDAP中也存在类似关系，每一个ObjectClass都定义了一些Attribute，其Attribute仍然可以是ObjectClass。在这些Attriubte中分为两种类型MUST，MAY， MUST表示这个Entry必须包括的属性，MAY为可选。一个ObjectClass的Attribute也包括所有继承自父ObjectClass和自身定义的ObjectClass。</p>

<p>下面用一个类型进行说明：</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>objectclass <span class="o">(</span> 2.5.6.0 NAME <span class="s1">'top'</span> ABSTRACT
    MUST objectClass <span class="o">)</span>
objectclass <span class="o">(</span> 1.3.6.1.4.1.1466.344 NAME <span class="s1">'dcObject'</span>
    DESC <span class="s1">'RFC2247: domain component object'</span>
    SUP top AUXILIARY
    MUST dc <span class="o">)</span>
</code></pre></div></div>

<p>上面是两个objectclass的定义，其中top为ABSTRACT，dcObject为AUXILIARY，这两个类型都不能定义Entry.下面这个LDIF文件在导入到LDAP时会出错：</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dn: <span class="nv">dc</span><span class="o">=</span>java,dc<span class="o">=</span>com
objectClass:dcObject
dc: java.com
</code></pre></div></div>

<p>要定义这个Entry必须找到一个STRUCTURAL类型的ObjectClass。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>objectClasses: <span class="o">(</span> 2.5.6.4 NAME <span class="s1">'organization'</span>
  DESC <span class="s1">'RFC2256: an organization'</span> SUP top STRUCTURAL
  MUST o
  MAY <span class="o">(</span> userPassword <span class="nv">$ </span>searchGuide <span class="nv">$ </span>seeAlso <span class="nv">$ </span>businessCategory
   <span class="nv">$ </span>x121Address <span class="nv">$ </span>registeredAddress <span class="nv">$ </span>destinationIndicator
   <span class="nv">$ </span>preferredDeliveryMethod <span class="nv">$ </span>telexNumber <span class="nv">$ </span>teletexTerminalIdentifier
   <span class="nv">$ </span>telephoneNumber <span class="nv">$ </span>internationaliSDNNumber <span class="nv">$ </span>facsimileTelephoneNumber
   <span class="nv">$ </span>street <span class="nv">$ </span>postOfficeBox <span class="nv">$ </span>postalCode <span class="nv">$ </span>postalAddress
   <span class="nv">$ </span>physicalDeliveryOfficeName <span class="nv">$ </span>st <span class="nv">$ </span>l <span class="nv">$ </span>description <span class="o">)</span> <span class="o">)</span>
</code></pre></div></div>

<p>这个objectClass的类型为STRUCTURAL，因此可以用来定义Entry.具体定义如下</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dn: <span class="nv">dc</span><span class="o">=</span>java,dc<span class="o">=</span>com
objectClass:dcObject
objectClass:organization
dc: java.com
o: java.com
</code></pre></div></div>

<p>其中dc：java.com为dcObject的MUST Attribute，o: java.com为organization的MUST Attribute。</p>

<h1 id="总结">总结</h1>

<p>只要清楚了ObjectClass与Attribute之间的关系，无论是用什么语言来操作ldap，都会增添很多信心。</p>

<h2 id="参考资料">参考资料：</h2>

<p><a href="http://www.zytrax.com/books/ldap/ape/" target="_blank">Appendix E: LDAP - Object Classes and Attributes</a></p>

</section>
<section class="page-nav">
    <br/>
    <p><a  href="/2017/07/04/ldap-server-centos7.html" class=""  >下一篇：在Centos7上搭建Ldap服务器</a></p>
    <p><a  href="/2017/05/30/accessed-web-inf-jsp.html" class=""  >上一篇：SpringMvc框架实现优雅的页面跳转</a></p>
</section>

	<div id="container"></div>
	<link rel="stylesheet" href="/media/gitment/style/default.css">
	<script src="/media/gitment/dist/gitment.browser.js"></script>
	<script type="text/javascript">
		var gitment = new Gitment({
		  //id: '页面 ID', // 可选。默认为 location.href
		  //id: location.href.split('/').pop().replace(/\.html/,''),
		  id: "正确的理解LDAP中的ObjectClass和Attribute",
		  owner: 'Valdanitooooo',
		  repo: 'Valdanitooooo.github.io',
		  oauth: {
		    client_id: 'ae8e1056fd0fdfa83dcd',
		    client_secret: '587645a41329e9870ebda97d8d1ce05b0003b714',
		  },
		})
		gitment.render('container')
	</script>



        </article>
        <footer>
        <p>Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a> &#64;
            <a href="http://github.com/Valdanitooooo/Valdanitooooo.github.io" target="_blank" title="项目主页">GitHub</a>
            | Hosted by <a href="https://pages.coding.me" target="_blank">Coding Pages</a>
            | © 2017 - 2018 <a href="/about/">Valdanito</a>
        </p>
        </footer>
    </div>
</body>
<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','1ZarQrPGsHydx-KkvfHz','2.0.0');
</script>
<script type="text/javascript" src="/media/js/script.js"></script>
</html>
